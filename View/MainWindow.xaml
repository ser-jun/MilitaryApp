<Window x:Class="MilitaryApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Military Structure Manager" 
        Height="768" Width="1366"
        WindowState="Maximized"
        ResizeMode="NoResize"
        FontFamily="Segoe UI"
        Background="#FFECEFF1">

    <Window.Resources>
        <!-- Стиль для кнопок -->
        <Style x:Key="MilitaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#FF37474F"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#FF263238"/>
            <Setter Property="Padding" Value="8 4"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FF455A64"/>
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect BlurRadius="4" Opacity="0.3" ShadowDepth="2"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Стиль для GroupBox -->
        <Style TargetType="GroupBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="10 5"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="BorderBrush" Value="#FF546E7A"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="#FF455A64"/>
        </Style>

        <!-- Стиль для ComboBox -->
        <Style TargetType="ComboBox">
            <Setter Property="Height" Value="32"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderBrush" Value="#FFB0BEC5"/>
        </Style>

        <!-- Стиль для TextBox -->
        <Style TargetType="TextBox">
            <Setter Property="Height" Value="32"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderBrush" Value="#FFB0BEC5"/>
        </Style>

        <!-- Стиль для TextBlock -->
        <Style TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="0 0 0 5"/>
        </Style>

        <!-- Стиль для CheckBox -->
        <Style TargetType="CheckBox">
            <Setter Property="Margin" Value="0 10 0 5"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>
    </Window.Resources>

    <DockPanel>
        <!-- Верхняя панель с фильтрами -->
        <Border DockPanel.Dock="Top" 
                Background="#FF37474F" 
                Padding="10"
                CornerRadius="0,0,8,8"
                BorderThickness="0,0,0,2"
                BorderBrush="#FF263238">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <GroupBox Header="Фильтрация">
                    <StackPanel Orientation="Horizontal">
                        <ComboBox ItemsSource="{Binding FilterTypes}" 
                                  SelectedItem="{Binding SelectedFilterType}"
                                  Width="180"/>

                        <StackPanel Orientation="Horizontal" 
                                    Visibility="{Binding ShowFilterControls}">
                            <ComboBox Width="180"
                                      ItemsSource="{Binding Armies}" 
                                      DisplayMemberPath="Name"
                                      SelectedValuePath="ArmyId"
                                      SelectedValue="{Binding SelectedArmyId}"
                                      Visibility="{Binding IsArmyFilterSelected}"/>

                            <ComboBox Width="180"
                                      ItemsSource="{Binding Divisions}" 
                                      DisplayMemberPath="Name"
                                      SelectedValuePath="DivisionId"
                                      SelectedValue="{Binding SelectedDivisionId}"
                                      Visibility="{Binding IsDivisionFilterSelected}"/>

                            <ComboBox Width="180"
                                      ItemsSource="{Binding Corps}" 
                                      DisplayMemberPath="Name"
                                      SelectedValuePath="CorpsId"
                                      SelectedValue="{Binding SelectedCorpsId}"
                                      Visibility="{Binding IsCorpsFilterSelected}"/>

                            <Button Content="Применить" 
                                    Width="100"
                                    Style="{StaticResource MilitaryButtonStyle}"
                                    Command="{Binding ApplyFilterCommand}"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="Анализ">
                    <StackPanel Orientation="Horizontal">
                        <ComboBox Width="200"
                                  ItemsSource="{Binding Parameters}"
                                  SelectedValue="{Binding SelectedParameter}"/>

                        <Button Content="Максимальное количество частей" 
                                Width="220"
                                Style="{StaticResource MilitaryButtonStyle}"
                                Command="{Binding GetMinMaxCountunitCommand}"/>

                        <Button Content="Очистить" 
                                Width="120"
                                Style="{StaticResource MilitaryButtonStyle}"
                                Command="{Binding ResetFiltersCommand}"/>
                    </StackPanel>
                </GroupBox>
            </StackPanel>
        </Border>

        <!-- Основное содержимое -->
        <Grid Margin="10,5,10,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*" />
                <ColumnDefinition Width="1*" />
            </Grid.ColumnDefinitions>

            <!-- Левая панель - таблица данных -->
            <Border Grid.Column="0" 
                    Background="White" 
                    CornerRadius="8"
                    Padding="5"
                    Margin="0,0,5,0"
                    BorderBrush="#FFB0BEC5"
                    BorderThickness="1">
                <DataGrid AutoGenerateColumns="False" 
                          ItemsSource="{Binding MilitaryStructureItems}" 
                          SelectedItem="{Binding SelectedItem}" 
                          SelectionMode="Single"
                          CanUserReorderColumns="False"
                          CanUserResizeColumns="True"
                          IsReadOnly="True"
                          GridLinesVisibility="None"
                          RowBackground="#FFF5F5F5"
                          AlternatingRowBackground="White"
                          BorderThickness="0"
                          FontSize="14"
                          HeadersVisibility="Column"
                          ColumnHeaderHeight="32"
                          RowHeight="32">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Army Name" Binding="{Binding ArmyName}" Width="*"/>
                        <DataGridTextColumn Header="Division Name" Binding="{Binding DivisionName}" Width="*"/>
                        <DataGridTextColumn Header="Corps Name" Binding="{Binding CorpsName}" Width="*"/>
                        <DataGridTextColumn Header="Unit Name" Binding="{Binding UnitName}" Width="*"/>
                        <DataGridTextColumn Header="Sub unit name" Binding="{Binding SubUnitName}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Border>

            <!-- Правая панель - управление -->
            <Border Grid.Column="1" 
                    Background="White" 
                    CornerRadius="8"
                    Padding="10"
                    BorderBrush="#FFB0BEC5"
                    BorderThickness="1">
                <StackPanel>
                    <TextBlock Text="Название" FontWeight="Bold"/>
                    <TextBox Text="{Binding NewItemName, UpdateSourceTrigger=PropertyChanged}"/>

                    <TextBlock Text="Тип структуры" FontWeight="Bold" Margin="0,10,0,0"/>
                    <ComboBox ItemsSource="{Binding StructureTypes}" 
                              SelectedItem="{Binding SelectedStructureType}"/>

                    <TextBlock Text="Родительский элемент" FontWeight="Bold" Margin="0,10,0,0"/>
                    <ComboBox ItemsSource="{Binding ParentItems}" 
                              SelectedItem="{Binding SelectedParentItem}" 
                              DisplayMemberPath="Name"
                              IsEnabled="{Binding IsParentSelectionEnabled}"/>

                    <CheckBox Content="Отключить автоматическое создание подразделений" 
                              IsChecked="{Binding DisableTriggers}"
                              Margin="0,10,0,5"/>

                    <!-- Упорядоченные кнопки в две колонки -->
                    <Grid Margin="0,10,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Button Command="{Binding AddItemCommand}" 
                                Content="Добавить" 
                                Style="{StaticResource MilitaryButtonStyle}"
                                Grid.Column="0" Grid.Row="0"/>
                        <Button Command="{Binding DeleteItemCommand}" 
                                Content="Удалить" 
                                Style="{StaticResource MilitaryButtonStyle}"
                                Grid.Column="1" Grid.Row="0"/>
                        <Button Command="{Binding UpdateItemCommand}" 
                                Content="Изменить" 
                                Style="{StaticResource MilitaryButtonStyle}"
                                Grid.Column="0" Grid.Row="1"/>
                        <Button Command="{Binding OpenPersonnelWindowCommand}" 
                                Content="Личный состав" 
                                Style="{StaticResource MilitaryButtonStyle}"
                                Grid.Column="1" Grid.Row="1"/>
                        <Button Command="{Binding OpenEquipmentWindowCommand}" 
                                Content="Техника" 
                                Style="{StaticResource MilitaryButtonStyle}"
                                Grid.Column="0" Grid.Row="2"/>
                        <Button Command="{Binding OpenWeaponWindowCommand}" 
                                Content="Вооружение" 
                                Style="{StaticResource MilitaryButtonStyle}"
                                Grid.Column="1" Grid.Row="2"/>
                        <Button Command="{Binding OpenInfrastructureWindowCommand}" 
                                Content="Инфраструктура" 
                                Style="{StaticResource MilitaryButtonStyle}"
                                Grid.Column="0" Grid.Row="3"/>
                        <Button Command="{Binding OpenMainPage}" 
                                Content="Главная" 
                                Style="{StaticResource MilitaryButtonStyle}"
                                Grid.Column="1" Grid.Row="3"/>
                    </Grid>
                </StackPanel>
            </Border>
        </Grid>
    </DockPanel>
</Window>